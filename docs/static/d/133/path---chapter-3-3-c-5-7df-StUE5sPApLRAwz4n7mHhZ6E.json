{"data":{"site":{"siteMetadata":{"courseId":"gams-in-r-course"}},"markdownRemark":{"htmlAst":{"type":"root","children":[{"type":"element","tagName":"exercise","properties":{"id":"1","title":"Two-dimensional smooths and spatial data","type":"slides"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"slides","properties":{"source":"chapter3_01"},"children":[{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"2","title":"Modeling soil pollution in the Netherlands"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s take a closer look at the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"meuse"}]},{"type":"text","value":" data and use it to fit your first 2-D model. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"After reviewing the model you will fit, answer the following question: "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"How many basis functions are used in the two-dimensional smooth?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Inspect the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"meuse"}]},{"type":"text","value":" data with the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"head()"}]},{"type":"text","value":" and "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"str()"}]},{"type":"text","value":" functions."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_02"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"head(meuse)"}]},{"type":"text","value":" and "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"str(meuse)"}]},{"type":"text","value":" will give you a glimpse at the variables in this data set."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Fit a GAM model to the data that predicts the concentration of cadmium in the soil using an interaction of x and y coordinates. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Inspect your model with the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"summary()"}]},{"type":"text","value":" and "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"coef()"}]},{"type":"text","value":" functions."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_02_1"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The formula syntax for an interaction in a GAM model is "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"s(x1, x2)"}]},{"type":"text","value":". "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Don’t forget to use the “REML” method in your GAM."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"(hint)\nLook at the output of "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"coef(mod2d)"}]},{"type":"text","value":". How many coefficients are associated with the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"s(x, y)"}]},{"type":"text","value":" smooth?It is sometimes helpful to round concurvity values for easier inspection, which you can do for each matrix like so "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"round(concurvity(mod, full = FALSE)$worst, 2)"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"choice","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"opt","properties":{"text":"10"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Incorrect. Remember, the number of basis functions is equal to the number of the smooth’s coefficients"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"opt","properties":{"text":"23"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Incorrect. Remember, the number of basis functions is equal to the number of the smooth’s coefficients"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"opt","properties":{"text":"29","correct":"true"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Correct! There are 29 coefficients in "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"s(x, y)"}]},{"type":"text","value":". Surfaces require more basis coefficients to construct than single variable smooths. That’s why the default value for "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"k"}]},{"type":"text","value":" is high for 2-D smooths."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"opt","properties":{"text":"36"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Incorrect. Remember, the number of basis functions is equal to the number of the smooth’s coefficients."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"3","title":"Adding more variables to predict soil pollution"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now let’s add additional predictors to the model with spatial interactions."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Instructions"}]},{"type":"text","value":"\nFit another model to predict cadmium in the soil, this time including smooths for the effect of elevation ("},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"elev"}]},{"type":"text","value":") and distance from the river ("},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dist"}]},{"type":"text","value":") in addition to an "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"y"}]},{"type":"text","value":" surface."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_03"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"To fit a model with both interaction and univariate smooths, use the syntax "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"s(x1, x2) + s(x3) + s(x4)"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Don’t forget to use the “REML” method"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"4","title":"Plotting and interpreting GAM interactions","type":"slides"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"slides","properties":{"source":"chapter3_04"},"children":[{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"5","title":"Plotting the model surface"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s explore the different visualization schemes available in "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"mgcv"}]},{"type":"text","value":"’s "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"plot()"}]},{"type":"text","value":" function."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The model you built in the last exercise ("},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"mod2da"}]},{"type":"text","value":") is available in your workspace."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Instructions"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Plot the interaction terms of "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"mod2da"}]},{"type":"text","value":" as a contour plot."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_05"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To display interaction terms as contour plot, call the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"plot()"}]},{"type":"text","value":" function."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Run the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"plot()"}]},{"type":"text","value":" function so interaction terms are displayed as 3D surfaces."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_05_1"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To display interaction terms as 3D surfaces, use "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"scheme = 1"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Run the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"plot()"}]},{"type":"text","value":" function so interaction terms are displayed as colored heat maps on a sigle page."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_05_2"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To display interaction terms as colored heat maps, use "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"scheme = 2"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"6","title":"Customizing 3D plots"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Uncertainty is easy to see in plots of univariate smooths, but more challenging to represent in 2D relationships.  Here we’ll visualize uncertainty in a geospatial interaction. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The model ("},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"mod2d"}]},{"type":"text","value":") from exercise 2 is available in your workspace."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_06"},"children":[{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Use "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"vis.gam()"}]},{"type":"text","value":" to make a 3D perspective plot of the x, y relationship in the model, using the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"se"}]},{"type":"text","value":" argument to make confidence interval surfaces at +/- 2 standard errors."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_06_1"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Use the parameter "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"plot.type = \"persp\""}]},{"type":"text","value":" to generate a 3D perspective plot. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"se"}]},{"type":"text","value":" parameter determines the distance of standard errors."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Make another version of the same plot, rotated 135 degrees to view it from another angle."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_06_2"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"theta"}]},{"type":"text","value":" parameter rotates the plot."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"7","title":"Extrapolation in surface plots"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"When making predictions from the models, it is important to understand how far from the range of your data you are extrapolating.  With multivariate smooths, the shape of the areas supported by data may be complex.  Here you’ll make plots that compare extrapolations to support in the data."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The model ("},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"mod2d"}]},{"type":"text","value":") from exercise 2 is available in your workspace."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Instructions"}]},{"type":"text","value":"\nMake a contour plot of the model using "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"vis.gam()"}]},{"type":"text","value":", extrapolating out from the data "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"5%"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_07"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"too.far"}]},{"type":"text","value":" argument determines how far from actual data to extrapolate as a % of the data range."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Make a contour plot of the model using "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"vis.gam()"}]},{"type":"text","value":", extrapolating out from the data "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"10%"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_07_1"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The argument "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"plot.type = \"contour\""}]},{"type":"text","value":" creates a contour-type plot."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Make a contour plot of the model using "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"vis.gam()"}]},{"type":"text","value":", extrapolating out from the data "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"25%"}]},{"type":"text","value":". "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Overlay the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"meuse"}]},{"type":"text","value":" data on top of your visualization as points."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_07_2"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Use the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"points()"}]},{"type":"text","value":" function to overlay the data."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"8","title":"Visualizing categorical-continuous interactions","type":"slides"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"slides","properties":{"source":"chapter3_08"},"children":[{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"9","title":"Soil pollution in different land uses"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"meuse"}]},{"type":"text","value":" data set has a factor variable, "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"landuse"}]},{"type":"text","value":", which specifies the type of land use or cover at the location where soil was sampled."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Instructions"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Using a categorical-continuous interaction (e.g., the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"by ="}]},{"type":"text","value":" form),  fit a model to the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"meuse"}]},{"type":"text","value":" data that predicts "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"copper"}]},{"type":"text","value":" levels as a function of "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dist"}]},{"type":"text","value":", with different smooths for each level of "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"landuse"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Include a separate term for varying intercepts for each level of "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"landuse"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Print the model summary."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_09"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The formula should look like "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"y ~ s(continuous_variable, by = categorical_variable) + categorical_variable"}]},{"type":"text","value":".  "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Don’t forget "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"method = \"REML\""}]},{"type":"text","value":" in your call to "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"gam()"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Instructions"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Fit a model with a factor-smooth interaction between "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dist"}]},{"type":"text","value":" and "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"landuse"}]},{"type":"text","value":" variables using the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"bs = \"fs\""}]},{"type":"text","value":" formulation."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Print the model summary."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_09_1"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The formula should look like "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"y ~ s(continuous_vairable, categorical_variable, bs = \"fs\")"}]},{"type":"text","value":". "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"A separate intercept term in not necessary for models of this form."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Don’t forget "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"method = \"REML\""}]},{"type":"text","value":" in your call to "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"gam()"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"10","title":"Plotting pollution in different land uses"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You can observe the differences between different continuous-categorical interaction types by visualizing them.  Here, you’ll look at the different ways the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"by"}]},{"type":"text","value":"-type and factor-smooth-type interactions are plotted, an see how the approaches fit the models differently."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Both the models ("},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"mod_sep"}]},{"type":"text","value":" and "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"mod_fs"}]},{"type":"text","value":") from the previous exercise are available in your workspace."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Instructions"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Plot both models using the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"plot()"}]},{"type":"text","value":" function, using the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pages"}]},{"type":"text","value":" argument to keep all terms on one plot."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_10"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Use "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pages = 1"}]},{"type":"text","value":" in the "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"plot()"}]},{"type":"text","value":" function to fit multiple plots onto a single page."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Plot both models making 3D perspective plots with "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"vis.gam()"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_10_1"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Use "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"plot.type = \"persp\""}]},{"type":"text","value":" to make perspective plots with "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"vis.gam()"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"11","title":"Interactions with different scales: Tensors","type":"slides"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"slides","properties":{"source":"chapter3_11"},"children":[{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"12","title":"Pollution models with multi-scale interactions"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"meuse"}]},{"type":"text","value":" dataset contains some predictor variables that are on the same scale ("},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"y"}]},{"type":"text","value":"), and some that are on different scales ("},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"elev"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dist"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"om"}]},{"type":"text","value":"). In a previous exercise, you fit a model where you predicted cadmium pollution as a function of location and elevation: "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"mod <- gam(cadmium ~ s(x, y) + s(elev), \n           data = meuse, method = \"REML\")"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In this exercise, you’ll build a model that allows multiple variables to interact despite these different scales using a tensor smooth, "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"te()"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Instructions"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Convert this to a model where "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"y"}]},{"type":"text","value":", and "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"elev"}]},{"type":"text","value":" all interact in a single "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"te()"}]},{"type":"text","value":" term, varying on their own scales. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Then summarize the model and visualize it with "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"plot()"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_12"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Tensor smooths can take more than two variables.  Use the syntax "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"te(x1, x2, x3)"}]},{"type":"text","value":". "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Don’t forget "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"method = \"REML\""}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"13","title":"Teasing apart multi-scale interactions"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In the previous exercise, you fit the following model: "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"tensor_mod <- gam(cadmium ~ te(x, y, elev), \n                  data = meuse, method = \"REML\")"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In this exercise, you will fit a model with smooths and tensor "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"interactions"}]},{"type":"text","value":" to separate out the independent and interacting effects of variables."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Instructions"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Convert the above model such that "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"text","value":" and "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"y"}]},{"type":"text","value":" interact on the same scale, the effect "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"elev"}]},{"type":"text","value":" is a separate smooth, and the interaction of all three on different scales is a separate term. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Summarize and plot the model."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"03_13"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Single-variable smooths use "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"s()"}]},{"type":"text","value":". "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Smooths in which multiple variables interact on the same scale also use "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"s()"}]},{"type":"text","value":". "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Smooths that have only interactions, but have multiple lambda terms or scales, use "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"ti()"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"frontmatter":{"id":3,"title":"3 - Spatial GAMs and Interactions","description":"In this chapter, you will extend the types of models you can fit to those with interactions of multiple variables.  You will fit models of geospatial data by using these interactions to model complex surfaces, and visualize those surfaces in 3D.  Then you will learn about interactions between smooth and categorical variables, and how to model interactions between very different variables like space and time.","next":"/chapter4","prev":"/chapter2"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/chapter3"}}